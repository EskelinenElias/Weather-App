<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Weather App</title>
        <!-- Stylesheet -->
        <link rel="stylesheet" href="stylesheets/styles.css">
        <link rel="stylesheet" href="stylesheets/header.css">
        <link rel="stylesheet" href="stylesheets/weather.css">
        <!-- Font Awesome icons -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    </head>
    <body> 
        <!-- Backgrounds container-->
        <div class="background-container">
            <div class="background background1"></div>
            <div class="background background2"></div>
        </div>
        <!-- Navigation bar -->
        <header>
            <nav class="navbar">
                <div class="container">
                    <div class="logo">
                        <h1><a href="index.html">Weather App</a></h1>
                    </div>
                    <div class="nav-items"> 
                        <button class="nav-button" id="map-button">Map</button>
                        <button class="nav-button" id="about-button">About</button>
                        <form id="search-form" class="search-form">
                            <input type="text" id="search-input" placeholder="Enter city name" required>
                        </form>
                    </div>
                </div>
            </nav>
        </header>
        <main>
            <div class="weather-main" id="weather-main"></div>
            <!--<div id="weather-container"></div>-->
        </main>
        <!-- Settings button -->
        <button class="icon-button" id="settings-button">
            <i class="fas fa-cog"></i>
        </button>
        <!-- Locate button -->
        <button class="icon-button" id="locate-button">
            <i class="fas fa-location-arrow"></i>
        </button>
        <!-- JavaScripts -->
        <script src="src/geolocation.js"></script>
        <script src="src/background.js"></script>
        <script src="src/weather.js"></script>
        <script src="src/app.js"></script>
        <script>
          // Add functionality to the about-page button
          document.getElementById("about-button").addEventListener("click", function() {
            window.location.href = "about.html";
          });
          // Add functionality to the map-page button
          document.getElementById("map-button").addEventListener("click", function() {
            window.location.href = "map.html";
          });
          // Add functionality to the search bar
          document.getElementById("search-form").addEventListener("submit", function() {
            event.preventDefault(); 
            const locationName = document.getElementById("search-input").value; 
            getWeatherByLocationName(locationName).then((weatherData) => {
              if (weatherData) {
                setExistingWeatherData(weatherData); 
                displayWeatherData(weatherData); 
                changeBackgroundAccordingToWeather(weatherData); 
              }
            }); 
          });
          document.getElementById("settings-button").addEventListener('click', () => {
            window.location.href = "settings.html";
          });
          // Add functionality to the locate button
          document.getElementById("locate-button").addEventListener('click', () => {
            event.preventDefault(); 
            console.log("Locating user...")
            getLocation().then((locationData) => {
              if (!locationData) {
                alert("Could not locate.")
                return; 
              }
              console.log("Getting weather data for location...")
              getWeatherDataForLocation(locationData).then((weatherData) => {
                if (!weatherData) {
                  alert("Could not get weather data for current location.")
                  return; 
                }
                console.log(weatherData); 
                // Display weather data and update background to match the weather
                displayWeatherData(weatherData); 
                changeBackgroundAccordingToWeather(weatherData); 
                // Save weather data for later use
                const locationData = {
                  latitude: weatherData.coord.latitude,
                  longitude: weatherData.coord.longitude
                }
                setExistingLocationData(locationData); 
                setExistingWeatherData(weatherData); 
              });
            }); 
          });
        </script>
    </body>
</html>